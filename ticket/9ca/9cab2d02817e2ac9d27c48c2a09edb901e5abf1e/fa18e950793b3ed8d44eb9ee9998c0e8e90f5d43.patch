diff -r 06facfeb754a twisted/internet/iocpreactor/iocpsupport/acceptex.pxi
--- a/twisted/internet/iocpreactor/iocpsupport/acceptex.pxi	Sun Jan 15 03:23:55 2012 +0100
+++ b/twisted/internet/iocpreactor/iocpsupport/acceptex.pxi	Sun Jan 15 18:47:42 2012 +0100
@@ -24,6 +24,7 @@
     if not rc:
         rc = WSAGetLastError()
         if rc != ERROR_IO_PENDING:
+            PyMem_Free(ov)
             return rc
 
     # operation is in progress
diff -r 06facfeb754a twisted/internet/iocpreactor/iocpsupport/connectex.pxi
--- a/twisted/internet/iocpreactor/iocpsupport/connectex.pxi	Sun Jan 15 03:23:55 2012 +0100
+++ b/twisted/internet/iocpreactor/iocpsupport/connectex.pxi	Sun Jan 15 18:47:42 2012 +0100
@@ -29,6 +29,7 @@
     if not rc:
         rc = WSAGetLastError()
         if rc != ERROR_IO_PENDING:
+            PyMem_Free(ov)
             return rc
 
     # operation is in progress
diff -r 06facfeb754a twisted/internet/iocpreactor/iocpsupport/iocpsupport.c
--- a/twisted/internet/iocpreactor/iocpsupport/iocpsupport.c	Sun Jan 15 03:23:55 2012 +0100
+++ b/twisted/internet/iocpreactor/iocpsupport/iocpsupport.c	Sun Jan 15 18:47:42 2012 +0100
@@ -1,4 +1,4 @@
-/* Generated by Cython 0.15.1 on Fri Nov 25 21:01:57 2011 */
+/* Generated by Cython 0.15.1 on Sun Jan 15 18:47:18 2012 */
 
 #define PY_SSIZE_T_CLEAN
 #include "Python.h"
@@ -1651,7 +1651,7 @@
  * 
  *         rc = PostQueuedCompletionStatus(self.port, bytes, key, <OVERLAPPED *>ov)             # <<<<<<<<<<<<<<
  *         if not rc:
- *             raise_error(0, 'PostQueuedCompletionStatus')
+ *             if ov:
  */
   __pyx_v_rc = PostQueuedCompletionStatus(((struct __pyx_obj_11iocpsupport_CompletionPort *)__pyx_v_self)->port, __pyx_v_bytes, __pyx_v_key, ((OVERLAPPED *)__pyx_v_ov));
 
@@ -1659,8 +1659,8 @@
  * 
  *         rc = PostQueuedCompletionStatus(self.port, bytes, key, <OVERLAPPED *>ov)
  *         if not rc:             # <<<<<<<<<<<<<<
- *             raise_error(0, 'PostQueuedCompletionStatus')
- * 
+ *             if ov:
+ *                 Py_DECREF(obj)
  */
   __pyx_t_1 = (!__pyx_v_rc);
   if (__pyx_t_1) {
@@ -1668,13 +1668,44 @@
     /* "iocpsupport.pyx":191
  *         rc = PostQueuedCompletionStatus(self.port, bytes, key, <OVERLAPPED *>ov)
  *         if not rc:
+ *             if ov:             # <<<<<<<<<<<<<<
+ *                 Py_DECREF(obj)
+ *                 PyMem_Free(ov)
+ */
+    __pyx_t_1 = (__pyx_v_ov != 0);
+    if (__pyx_t_1) {
+
+      /* "iocpsupport.pyx":192
+ *         if not rc:
+ *             if ov:
+ *                 Py_DECREF(obj)             # <<<<<<<<<<<<<<
+ *                 PyMem_Free(ov)
+ *             raise_error(0, 'PostQueuedCompletionStatus')
+ */
+      Py_DECREF(__pyx_v_obj);
+
+      /* "iocpsupport.pyx":193
+ *             if ov:
+ *                 Py_DECREF(obj)
+ *                 PyMem_Free(ov)             # <<<<<<<<<<<<<<
+ *             raise_error(0, 'PostQueuedCompletionStatus')
+ * 
+ */
+      PyMem_Free(__pyx_v_ov);
+      goto __pyx_L8;
+    }
+    __pyx_L8:;
+
+    /* "iocpsupport.pyx":194
+ *                 Py_DECREF(obj)
+ *                 PyMem_Free(ov)
  *             raise_error(0, 'PostQueuedCompletionStatus')             # <<<<<<<<<<<<<<
  * 
  *     def __del__(self):
  */
     __pyx_t_3 = ((PyObject *)__pyx_n_s_2);
     __Pyx_INCREF(__pyx_t_3);
-    __pyx_f_11iocpsupport_raise_error(0, __pyx_t_3); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_f_11iocpsupport_raise_error(0, __pyx_t_3); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L7;
   }
@@ -1692,7 +1723,7 @@
   return __pyx_r;
 }
 
-/* "iocpsupport.pyx":193
+/* "iocpsupport.pyx":196
  *             raise_error(0, 'PostQueuedCompletionStatus')
  * 
  *     def __del__(self):             # <<<<<<<<<<<<<<
@@ -1706,7 +1737,7 @@
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__del__");
 
-  /* "iocpsupport.pyx":194
+  /* "iocpsupport.pyx":197
  * 
  *     def __del__(self):
  *         CloseHandle(self.port)             # <<<<<<<<<<<<<<
@@ -1721,7 +1752,7 @@
   return __pyx_r;
 }
 
-/* "iocpsupport.pyx":196
+/* "iocpsupport.pyx":199
  *         CloseHandle(self.port)
  * 
  * def makesockaddr(object buff):             # <<<<<<<<<<<<<<
@@ -1744,16 +1775,16 @@
   __Pyx_RefNannySetupContext("makesockaddr");
   __pyx_self = __pyx_self;
 
-  /* "iocpsupport.pyx":200
+  /* "iocpsupport.pyx":203
  *     cdef Py_ssize_t size
  * 
  *     PyObject_AsReadBuffer(buff, &mem_buffer, &size)             # <<<<<<<<<<<<<<
  *     # XXX: this should really return the address family as well
  *     return _makesockaddr(<sockaddr *>mem_buffer, size)
  */
-  __pyx_t_1 = PyObject_AsReadBuffer(__pyx_v_buff, (&__pyx_v_mem_buffer), (&__pyx_v_size)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-  /* "iocpsupport.pyx":202
+  __pyx_t_1 = PyObject_AsReadBuffer(__pyx_v_buff, (&__pyx_v_mem_buffer), (&__pyx_v_size)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+
+  /* "iocpsupport.pyx":205
  *     PyObject_AsReadBuffer(buff, &mem_buffer, &size)
  *     # XXX: this should really return the address family as well
  *     return _makesockaddr(<sockaddr *>mem_buffer, size)             # <<<<<<<<<<<<<<
@@ -1761,7 +1792,7 @@
  * cdef object _makesockaddr(sockaddr *addr, Py_ssize_t len):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __pyx_f_11iocpsupport__makesockaddr(((struct sockaddr *)__pyx_v_mem_buffer), __pyx_v_size); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = __pyx_f_11iocpsupport__makesockaddr(((struct sockaddr *)__pyx_v_mem_buffer), __pyx_v_size); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
@@ -1779,7 +1810,7 @@
   return __pyx_r;
 }
 
-/* "iocpsupport.pyx":204
+/* "iocpsupport.pyx":207
  *     return _makesockaddr(<sockaddr *>mem_buffer, size)
  * 
  * cdef object _makesockaddr(sockaddr *addr, Py_ssize_t len):             # <<<<<<<<<<<<<<
@@ -1810,7 +1841,7 @@
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_makesockaddr");
 
-  /* "iocpsupport.pyx":209
+  /* "iocpsupport.pyx":212
  *     cdef char buff[256]
  *     cdef int rc
  *     cdef DWORD buff_size = sizeof(buff)             # <<<<<<<<<<<<<<
@@ -1819,7 +1850,7 @@
  */
   __pyx_v_buff_size = (sizeof(__pyx_v_buff));
 
-  /* "iocpsupport.pyx":210
+  /* "iocpsupport.pyx":213
  *     cdef int rc
  *     cdef DWORD buff_size = sizeof(buff)
  *     if not len:             # <<<<<<<<<<<<<<
@@ -1829,7 +1860,7 @@
   __pyx_t_1 = (!__pyx_v_len);
   if (__pyx_t_1) {
 
-    /* "iocpsupport.pyx":211
+    /* "iocpsupport.pyx":214
  *     cdef DWORD buff_size = sizeof(buff)
  *     if not len:
  *         return None             # <<<<<<<<<<<<<<
@@ -1844,7 +1875,7 @@
   }
   __pyx_L3:;
 
-  /* "iocpsupport.pyx":215
+  /* "iocpsupport.pyx":218
  *         sin = <sockaddr_in *>addr
  *         return PyString_FromString(inet_ntoa(sin.sin_addr)), ntohs(sin.sin_port)
  *     elif addr.sa_family == AF_INET6:             # <<<<<<<<<<<<<<
@@ -1853,7 +1884,7 @@
  */
   switch (__pyx_v_addr->sa_family) {
 
-    /* "iocpsupport.pyx":212
+    /* "iocpsupport.pyx":215
  *     if not len:
  *         return None
  *     if addr.sa_family == AF_INET:             # <<<<<<<<<<<<<<
@@ -1862,7 +1893,7 @@
  */
     case AF_INET:
 
-    /* "iocpsupport.pyx":213
+    /* "iocpsupport.pyx":216
  *         return None
  *     if addr.sa_family == AF_INET:
  *         sin = <sockaddr_in *>addr             # <<<<<<<<<<<<<<
@@ -1871,7 +1902,7 @@
  */
     __pyx_v_sin = ((struct sockaddr_in *)__pyx_v_addr);
 
-    /* "iocpsupport.pyx":214
+    /* "iocpsupport.pyx":217
  *     if addr.sa_family == AF_INET:
  *         sin = <sockaddr_in *>addr
  *         return PyString_FromString(inet_ntoa(sin.sin_addr)), ntohs(sin.sin_port)             # <<<<<<<<<<<<<<
@@ -1879,11 +1910,11 @@
  *         sin6 = <sockaddr_in6 *>addr
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = PyString_FromString(inet_ntoa(__pyx_v_sin->sin_addr)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyString_FromString(inet_ntoa(__pyx_v_sin->sin_addr)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyInt_FromLong(ntohs(__pyx_v_sin->sin_port)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyInt_FromLong(ntohs(__pyx_v_sin->sin_port)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(((PyObject *)__pyx_t_4));
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_2);
@@ -1896,7 +1927,7 @@
     goto __pyx_L0;
     break;
 
-    /* "iocpsupport.pyx":215
+    /* "iocpsupport.pyx":218
  *         sin = <sockaddr_in *>addr
  *         return PyString_FromString(inet_ntoa(sin.sin_addr)), ntohs(sin.sin_port)
  *     elif addr.sa_family == AF_INET6:             # <<<<<<<<<<<<<<
@@ -1905,7 +1936,7 @@
  */
     case AF_INET6:
 
-    /* "iocpsupport.pyx":216
+    /* "iocpsupport.pyx":219
  *         return PyString_FromString(inet_ntoa(sin.sin_addr)), ntohs(sin.sin_port)
  *     elif addr.sa_family == AF_INET6:
  *         sin6 = <sockaddr_in6 *>addr             # <<<<<<<<<<<<<<
@@ -1914,7 +1945,7 @@
  */
     __pyx_v_sin6 = ((struct sockaddr_in6 *)__pyx_v_addr);
 
-    /* "iocpsupport.pyx":217
+    /* "iocpsupport.pyx":220
  *     elif addr.sa_family == AF_INET6:
  *         sin6 = <sockaddr_in6 *>addr
  *         rc = WSAAddressToStringA(addr, sizeof(sockaddr_in6), NULL, buff, &buff_size)             # <<<<<<<<<<<<<<
@@ -1923,7 +1954,7 @@
  */
     __pyx_v_rc = WSAAddressToStringA(__pyx_v_addr, (sizeof(struct sockaddr_in6)), NULL, __pyx_v_buff, (&__pyx_v_buff_size));
 
-    /* "iocpsupport.pyx":218
+    /* "iocpsupport.pyx":221
  *         sin6 = <sockaddr_in6 *>addr
  *         rc = WSAAddressToStringA(addr, sizeof(sockaddr_in6), NULL, buff, &buff_size)
  *         if rc == SOCKET_ERROR:             # <<<<<<<<<<<<<<
@@ -1933,7 +1964,7 @@
     __pyx_t_1 = (__pyx_v_rc == SOCKET_ERROR);
     if (__pyx_t_1) {
 
-      /* "iocpsupport.pyx":219
+      /* "iocpsupport.pyx":222
  *         rc = WSAAddressToStringA(addr, sizeof(sockaddr_in6), NULL, buff, &buff_size)
  *         if rc == SOCKET_ERROR:
  *             raise_error(0, 'WSAAddressToString')             # <<<<<<<<<<<<<<
@@ -1942,36 +1973,36 @@
  */
       __pyx_t_4 = ((PyObject *)__pyx_n_s__WSAAddressToString);
       __Pyx_INCREF(__pyx_t_4);
-      __pyx_f_11iocpsupport_raise_error(0, __pyx_t_4); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_f_11iocpsupport_raise_error(0, __pyx_t_4); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       goto __pyx_L4;
     }
     __pyx_L4:;
 
-    /* "iocpsupport.pyx":220
+    /* "iocpsupport.pyx":223
  *         if rc == SOCKET_ERROR:
  *             raise_error(0, 'WSAAddressToString')
  *         host, sa_port = PyString_FromString(buff), ntohs(sin6.sin6_port)             # <<<<<<<<<<<<<<
  *         host, port = host.rsplit(':', 1)
  *         port = int(port)
  */
-    __pyx_t_4 = PyString_FromString(__pyx_v_buff); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyString_FromString(__pyx_v_buff); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_5 = ntohs(__pyx_v_sin6->sin6_port);
     __pyx_v_host = __pyx_t_4;
     __pyx_t_4 = 0;
     __pyx_v_sa_port = __pyx_t_5;
 
-    /* "iocpsupport.pyx":221
+    /* "iocpsupport.pyx":224
  *             raise_error(0, 'WSAAddressToString')
  *         host, sa_port = PyString_FromString(buff), ntohs(sin6.sin6_port)
  *         host, port = host.rsplit(':', 1)             # <<<<<<<<<<<<<<
  *         port = int(port)
  *         assert host[0] == '['
  */
-    __pyx_t_4 = PyObject_GetAttr(__pyx_v_host, __pyx_n_s__rsplit); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_4 = PyObject_GetAttr(__pyx_v_host, __pyx_n_s__rsplit); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_k_tuple_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_k_tuple_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
@@ -1980,7 +2011,7 @@
         if (unlikely(PyTuple_GET_SIZE(sequence) != 2)) {
           if (PyTuple_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
           else __Pyx_RaiseNeedMoreValuesError(PyTuple_GET_SIZE(sequence));
-          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         __pyx_t_4 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
@@ -1988,7 +2019,7 @@
         if (unlikely(PyList_GET_SIZE(sequence) != 2)) {
           if (PyList_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
           else __Pyx_RaiseNeedMoreValuesError(PyList_GET_SIZE(sequence));
-          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
         }
         __pyx_t_4 = PyList_GET_ITEM(sequence, 0); 
         __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
@@ -1998,7 +2029,7 @@
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_6 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_t_7 = Py_TYPE(__pyx_t_6)->tp_iternext;
@@ -2006,14 +2037,14 @@
       __Pyx_GOTREF(__pyx_t_4);
       index = 1; __pyx_t_2 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_2);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       goto __pyx_L6_unpacking_done;
       __pyx_L5_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (PyErr_Occurred() && PyErr_ExceptionMatches(PyExc_StopIteration)) PyErr_Clear();
       if (!PyErr_Occurred()) __Pyx_RaiseNeedMoreValuesError(index);
-      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __pyx_L6_unpacking_done:;
     }
     __Pyx_DECREF(__pyx_v_host);
@@ -2022,26 +2053,26 @@
     __pyx_v_port = __pyx_t_2;
     __pyx_t_2 = 0;
 
-    /* "iocpsupport.pyx":222
+    /* "iocpsupport.pyx":225
  *         host, sa_port = PyString_FromString(buff), ntohs(sin6.sin6_port)
  *         host, port = host.rsplit(':', 1)
  *         port = int(port)             # <<<<<<<<<<<<<<
  *         assert host[0] == '['
  *         assert host[-1] == ']'
  */
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(((PyObject *)__pyx_t_3));
     __Pyx_INCREF(__pyx_v_port);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_port);
     __Pyx_GIVEREF(__pyx_v_port);
-    __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_v_port);
     __pyx_v_port = __pyx_t_2;
     __pyx_t_2 = 0;
 
-    /* "iocpsupport.pyx":223
+    /* "iocpsupport.pyx":226
  *         host, port = host.rsplit(':', 1)
  *         port = int(port)
  *         assert host[0] == '['             # <<<<<<<<<<<<<<
@@ -2049,17 +2080,17 @@
  *         assert port == sa_port
  */
     #ifndef CYTHON_WITHOUT_ASSERTIONS
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_host, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_host, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyString_Equals(__pyx_t_2, ((PyObject *)__pyx_kp_s_5), Py_EQ); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_PyString_Equals(__pyx_t_2, ((PyObject *)__pyx_kp_s_5), Py_EQ); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (unlikely(!__pyx_t_1)) {
       PyErr_SetNone(PyExc_AssertionError);
-      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     #endif
 
-    /* "iocpsupport.pyx":224
+    /* "iocpsupport.pyx":227
  *         port = int(port)
  *         assert host[0] == '['
  *         assert host[-1] == ']'             # <<<<<<<<<<<<<<
@@ -2067,17 +2098,17 @@
  *         return host[1:-1], port
  */
     #ifndef CYTHON_WITHOUT_ASSERTIONS
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_host, -1, sizeof(long), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_host, -1, sizeof(long), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyString_Equals(__pyx_t_2, ((PyObject *)__pyx_kp_s_6), Py_EQ); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_PyString_Equals(__pyx_t_2, ((PyObject *)__pyx_kp_s_6), Py_EQ); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (unlikely(!__pyx_t_1)) {
       PyErr_SetNone(PyExc_AssertionError);
-      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     #endif
 
-    /* "iocpsupport.pyx":225
+    /* "iocpsupport.pyx":228
  *         assert host[0] == '['
  *         assert host[-1] == ']'
  *         assert port == sa_port             # <<<<<<<<<<<<<<
@@ -2085,20 +2116,20 @@
  *     else:
  */
     #ifndef CYTHON_WITHOUT_ASSERTIONS
-    __pyx_t_2 = PyInt_FromLong(__pyx_v_sa_port); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyInt_FromLong(__pyx_v_sa_port); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_port, __pyx_t_2, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_RichCompare(__pyx_v_port, __pyx_t_2, Py_EQ); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (unlikely(!__pyx_t_1)) {
       PyErr_SetNone(PyExc_AssertionError);
-      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     }
     #endif
 
-    /* "iocpsupport.pyx":226
+    /* "iocpsupport.pyx":229
  *         assert host[-1] == ']'
  *         assert port == sa_port
  *         return host[1:-1], port             # <<<<<<<<<<<<<<
@@ -2106,9 +2137,9 @@
  *         return PyString_FromStringAndSize(addr.sa_data, sizeof(addr.sa_data))
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_PySequence_GetSlice(__pyx_v_host, 1, -1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = __Pyx_PySequence_GetSlice(__pyx_v_host, 1, -1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(((PyObject *)__pyx_t_2));
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_3);
@@ -2122,7 +2153,7 @@
     break;
     default:
 
-    /* "iocpsupport.pyx":228
+    /* "iocpsupport.pyx":231
  *         return host[1:-1], port
  *     else:
  *         return PyString_FromStringAndSize(addr.sa_data, sizeof(addr.sa_data))             # <<<<<<<<<<<<<<
@@ -2130,7 +2161,7 @@
  * cdef object fillinetaddr(sockaddr_in *dest, object addr):
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_2 = PyString_FromStringAndSize(__pyx_v_addr->sa_data, (sizeof(__pyx_v_addr->sa_data))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_2 = PyString_FromStringAndSize(__pyx_v_addr->sa_data, (sizeof(__pyx_v_addr->sa_data))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
@@ -2155,7 +2186,7 @@
   return __pyx_r;
 }
 
-/* "iocpsupport.pyx":230
+/* "iocpsupport.pyx":233
  *         return PyString_FromStringAndSize(addr.sa_data, sizeof(addr.sa_data))
  * 
  * cdef object fillinetaddr(sockaddr_in *dest, object addr):             # <<<<<<<<<<<<<<
@@ -2182,7 +2213,7 @@
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("fillinetaddr");
 
-  /* "iocpsupport.pyx":234
+  /* "iocpsupport.pyx":237
  *     cdef unsigned long res
  *     cdef char *hoststr
  *     host, port = addr             # <<<<<<<<<<<<<<
@@ -2195,7 +2226,7 @@
       if (unlikely(PyTuple_GET_SIZE(sequence) != 2)) {
         if (PyTuple_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
         else __Pyx_RaiseNeedMoreValuesError(PyTuple_GET_SIZE(sequence));
-        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
@@ -2203,7 +2234,7 @@
       if (unlikely(PyList_GET_SIZE(sequence) != 2)) {
         if (PyList_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
         else __Pyx_RaiseNeedMoreValuesError(PyList_GET_SIZE(sequence));
-        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       }
       __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
       __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
@@ -2212,40 +2243,40 @@
     __Pyx_INCREF(__pyx_t_2);
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_3 = PyObject_GetIter(__pyx_v_addr); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_t_3 = PyObject_GetIter(__pyx_v_addr); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext;
     index = 0; __pyx_t_1 = __pyx_t_4(__pyx_t_3); if (unlikely(!__pyx_t_1)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_1);
     index = 1; __pyx_t_2 = __pyx_t_4(__pyx_t_3); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_2);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_4(__pyx_t_3), 2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_4(__pyx_t_3), 2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L4_unpacking_done;
     __pyx_L3_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (PyErr_Occurred() && PyErr_ExceptionMatches(PyExc_StopIteration)) PyErr_Clear();
     if (!PyErr_Occurred()) __Pyx_RaiseNeedMoreValuesError(index);
-    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __pyx_L4_unpacking_done:;
   }
-  __pyx_t_5 = __Pyx_PyInt_AsUnsignedShort(__pyx_t_2); if (unlikely((__pyx_t_5 == (unsigned short)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = __Pyx_PyInt_AsUnsignedShort(__pyx_t_2); if (unlikely((__pyx_t_5 == (unsigned short)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_host = __pyx_t_1;
   __pyx_t_1 = 0;
   __pyx_v_port = __pyx_t_5;
 
-  /* "iocpsupport.pyx":236
+  /* "iocpsupport.pyx":239
  *     host, port = addr
  * 
  *     hoststr = PyString_AsString(host)             # <<<<<<<<<<<<<<
  *     res = inet_addr(hoststr)
  *     if res == INADDR_ANY:
  */
-  __pyx_t_6 = PyString_AsString(__pyx_v_host); if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyString_AsString(__pyx_v_host); if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_hoststr = __pyx_t_6;
 
-  /* "iocpsupport.pyx":237
+  /* "iocpsupport.pyx":240
  * 
  *     hoststr = PyString_AsString(host)
  *     res = inet_addr(hoststr)             # <<<<<<<<<<<<<<
@@ -2254,7 +2285,7 @@
  */
   __pyx_v_res = inet_addr(__pyx_v_hoststr);
 
-  /* "iocpsupport.pyx":238
+  /* "iocpsupport.pyx":241
  *     hoststr = PyString_AsString(host)
  *     res = inet_addr(hoststr)
  *     if res == INADDR_ANY:             # <<<<<<<<<<<<<<
@@ -2264,7 +2295,7 @@
   __pyx_t_7 = (__pyx_v_res == INADDR_ANY);
   if (__pyx_t_7) {
 
-    /* "iocpsupport.pyx":239
+    /* "iocpsupport.pyx":242
  *     res = inet_addr(hoststr)
  *     if res == INADDR_ANY:
  *         raise ValueError, 'invalid IP address'             # <<<<<<<<<<<<<<
@@ -2272,12 +2303,12 @@
  * 
  */
     __Pyx_Raise(__pyx_builtin_ValueError, ((PyObject *)__pyx_kp_s_7), 0, 0);
-    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L5;
   }
   __pyx_L5:;
 
-  /* "iocpsupport.pyx":240
+  /* "iocpsupport.pyx":243
  *     if res == INADDR_ANY:
  *         raise ValueError, 'invalid IP address'
  *     dest.sin_addr.s_addr = res             # <<<<<<<<<<<<<<
@@ -2286,7 +2317,7 @@
  */
   __pyx_v_dest->sin_addr.s_addr = __pyx_v_res;
 
-  /* "iocpsupport.pyx":242
+  /* "iocpsupport.pyx":245
  *     dest.sin_addr.s_addr = res
  * 
  *     dest.sin_port = htons(port)             # <<<<<<<<<<<<<<
@@ -2310,7 +2341,7 @@
   return __pyx_r;
 }
 
-/* "iocpsupport.pyx":244
+/* "iocpsupport.pyx":247
  *     dest.sin_port = htons(port)
  * 
  * def AllocateReadBuffer(int size):             # <<<<<<<<<<<<<<
@@ -2331,7 +2362,7 @@
   __Pyx_RefNannySetupContext("AllocateReadBuffer");
   __pyx_self = __pyx_self;
   assert(__pyx_arg_size); {
-    __pyx_v_size = __Pyx_PyInt_AsInt(__pyx_arg_size); if (unlikely((__pyx_v_size == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_size = __Pyx_PyInt_AsInt(__pyx_arg_size); if (unlikely((__pyx_v_size == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
@@ -2340,7 +2371,7 @@
   return NULL;
   __pyx_L4_argument_unpacking_done:;
 
-  /* "iocpsupport.pyx":245
+  /* "iocpsupport.pyx":248
  * 
  * def AllocateReadBuffer(int size):
  *     return PyBuffer_New(size)             # <<<<<<<<<<<<<<
@@ -2348,7 +2379,7 @@
  * def maxAddrLen(long s):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyBuffer_New(__pyx_v_size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyBuffer_New(__pyx_v_size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
@@ -2366,7 +2397,7 @@
   return __pyx_r;
 }
 
-/* "iocpsupport.pyx":247
+/* "iocpsupport.pyx":250
  *     return PyBuffer_New(size)
  * 
  * def maxAddrLen(long s):             # <<<<<<<<<<<<<<
@@ -2391,7 +2422,7 @@
   __Pyx_RefNannySetupContext("maxAddrLen");
   __pyx_self = __pyx_self;
   assert(__pyx_arg_s); {
-    __pyx_v_s = __Pyx_PyInt_AsLong(__pyx_arg_s); if (unlikely((__pyx_v_s == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_s = __Pyx_PyInt_AsLong(__pyx_arg_s); if (unlikely((__pyx_v_s == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
@@ -2400,7 +2431,7 @@
   return NULL;
   __pyx_L4_argument_unpacking_done:;
 
-  /* "iocpsupport.pyx":251
+  /* "iocpsupport.pyx":254
  *     cdef int size, rc
  * 
  *     size = sizeof(wsa_pi)             # <<<<<<<<<<<<<<
@@ -2409,7 +2440,7 @@
  */
   __pyx_v_size = (sizeof(__pyx_v_wsa_pi));
 
-  /* "iocpsupport.pyx":252
+  /* "iocpsupport.pyx":255
  * 
  *     size = sizeof(wsa_pi)
  *     rc = getsockopt(s, SOL_SOCKET, SO_PROTOCOL_INFO, <char *>&wsa_pi, &size)             # <<<<<<<<<<<<<<
@@ -2418,7 +2449,7 @@
  */
   __pyx_v_rc = getsockopt(__pyx_v_s, SOL_SOCKET, SO_PROTOCOL_INFO, ((char *)(&__pyx_v_wsa_pi)), (&__pyx_v_size));
 
-  /* "iocpsupport.pyx":253
+  /* "iocpsupport.pyx":256
  *     size = sizeof(wsa_pi)
  *     rc = getsockopt(s, SOL_SOCKET, SO_PROTOCOL_INFO, <char *>&wsa_pi, &size)
  *     if rc == SOCKET_ERROR:             # <<<<<<<<<<<<<<
@@ -2428,7 +2459,7 @@
   __pyx_t_1 = (__pyx_v_rc == SOCKET_ERROR);
   if (__pyx_t_1) {
 
-    /* "iocpsupport.pyx":254
+    /* "iocpsupport.pyx":257
  *     rc = getsockopt(s, SOL_SOCKET, SO_PROTOCOL_INFO, <char *>&wsa_pi, &size)
  *     if rc == SOCKET_ERROR:
  *         raise_error(WSAGetLastError(), 'getsockopt')             # <<<<<<<<<<<<<<
@@ -2437,13 +2468,13 @@
  */
     __pyx_t_2 = ((PyObject *)__pyx_n_s__getsockopt);
     __Pyx_INCREF(__pyx_t_2);
-    __pyx_f_11iocpsupport_raise_error(WSAGetLastError(), __pyx_t_2); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_f_11iocpsupport_raise_error(WSAGetLastError(), __pyx_t_2); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     goto __pyx_L5;
   }
   __pyx_L5:;
 
-  /* "iocpsupport.pyx":255
+  /* "iocpsupport.pyx":258
  *     if rc == SOCKET_ERROR:
  *         raise_error(WSAGetLastError(), 'getsockopt')
  *     return wsa_pi.iMaxSockAddr             # <<<<<<<<<<<<<<
@@ -2451,7 +2482,7 @@
  * cdef int getAddrFamily(SOCKET s) except *:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_wsa_pi.iMaxSockAddr); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_wsa_pi.iMaxSockAddr); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
@@ -2469,7 +2500,7 @@
   return __pyx_r;
 }
 
-/* "iocpsupport.pyx":257
+/* "iocpsupport.pyx":260
  *     return wsa_pi.iMaxSockAddr
  * 
  * cdef int getAddrFamily(SOCKET s) except *:             # <<<<<<<<<<<<<<
@@ -2490,7 +2521,7 @@
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("getAddrFamily");
 
-  /* "iocpsupport.pyx":261
+  /* "iocpsupport.pyx":264
  *     cdef int size, rc
  * 
  *     size = sizeof(wsa_pi)             # <<<<<<<<<<<<<<
@@ -2499,7 +2530,7 @@
  */
   __pyx_v_size = (sizeof(__pyx_v_wsa_pi));
 
-  /* "iocpsupport.pyx":262
+  /* "iocpsupport.pyx":265
  * 
  *     size = sizeof(wsa_pi)
  *     rc = getsockopt(s, SOL_SOCKET, SO_PROTOCOL_INFO, <char *>&wsa_pi, &size)             # <<<<<<<<<<<<<<
@@ -2508,7 +2539,7 @@
  */
   __pyx_v_rc = getsockopt(__pyx_v_s, SOL_SOCKET, SO_PROTOCOL_INFO, ((char *)(&__pyx_v_wsa_pi)), (&__pyx_v_size));
 
-  /* "iocpsupport.pyx":263
+  /* "iocpsupport.pyx":266
  *     size = sizeof(wsa_pi)
  *     rc = getsockopt(s, SOL_SOCKET, SO_PROTOCOL_INFO, <char *>&wsa_pi, &size)
  *     if rc == SOCKET_ERROR:             # <<<<<<<<<<<<<<
@@ -2518,7 +2549,7 @@
   __pyx_t_1 = (__pyx_v_rc == SOCKET_ERROR);
   if (__pyx_t_1) {
 
-    /* "iocpsupport.pyx":264
+    /* "iocpsupport.pyx":267
  *     rc = getsockopt(s, SOL_SOCKET, SO_PROTOCOL_INFO, <char *>&wsa_pi, &size)
  *     if rc == SOCKET_ERROR:
  *         raise_error(WSAGetLastError(), 'getsockopt')             # <<<<<<<<<<<<<<
@@ -2527,13 +2558,13 @@
  */
     __pyx_t_2 = ((PyObject *)__pyx_n_s__getsockopt);
     __Pyx_INCREF(__pyx_t_2);
-    __pyx_f_11iocpsupport_raise_error(WSAGetLastError(), __pyx_t_2); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    __pyx_f_11iocpsupport_raise_error(WSAGetLastError(), __pyx_t_2); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     goto __pyx_L3;
   }
   __pyx_L3:;
 
-  /* "iocpsupport.pyx":265
+  /* "iocpsupport.pyx":268
  *     if rc == SOCKET_ERROR:
  *         raise_error(WSAGetLastError(), 'getsockopt')
  *     return wsa_pi.iAddressFamily             # <<<<<<<<<<<<<<
@@ -2714,7 +2745,7 @@
  *     if not rc:
  *         rc = WSAGetLastError()             # <<<<<<<<<<<<<<
  *         if rc != ERROR_IO_PENDING:
- *             return rc
+ *             PyMem_Free(ov)
  */
     __pyx_v_rc = WSAGetLastError();
 
@@ -2722,8 +2753,8 @@
  *     if not rc:
  *         rc = WSAGetLastError()
  *         if rc != ERROR_IO_PENDING:             # <<<<<<<<<<<<<<
+ *             PyMem_Free(ov)
  *             return rc
- * 
  */
     __pyx_t_3 = (__pyx_v_rc != ERROR_IO_PENDING);
     if (__pyx_t_3) {
@@ -2731,12 +2762,21 @@
       /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":27
  *         rc = WSAGetLastError()
  *         if rc != ERROR_IO_PENDING:
+ *             PyMem_Free(ov)             # <<<<<<<<<<<<<<
+ *             return rc
+ * 
+ */
+      PyMem_Free(__pyx_v_ov);
+
+      /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":28
+ *         if rc != ERROR_IO_PENDING:
+ *             PyMem_Free(ov)
  *             return rc             # <<<<<<<<<<<<<<
  * 
  *     # operation is in progress
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_4 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_r = __pyx_t_4;
       __pyx_t_4 = 0;
@@ -2748,7 +2788,7 @@
   }
   __pyx_L7:;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":30
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":31
  * 
  *     # operation is in progress
  *     Py_XINCREF(obj)             # <<<<<<<<<<<<<<
@@ -2757,7 +2797,7 @@
  */
   Py_XINCREF(__pyx_v_obj);
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":31
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":32
  *     # operation is in progress
  *     Py_XINCREF(obj)
  *     return 0             # <<<<<<<<<<<<<<
@@ -2781,7 +2821,7 @@
   return __pyx_r;
 }
 
-/* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":33
+/* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":34
  *     return 0
  * 
  * def get_accept_addrs(long s, object buff):             # <<<<<<<<<<<<<<
@@ -2833,11 +2873,11 @@
         values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__buff);
         if (likely(values[1])) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_accept_addrs", 1, 2, 2, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+          __Pyx_RaiseArgtupleInvalid("get_accept_addrs", 1, 2, 2, 1); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "get_accept_addrs") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "get_accept_addrs") < 0)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
@@ -2845,28 +2885,28 @@
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
-    __pyx_v_s = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_s == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_s = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_s == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     __pyx_v_buff = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_accept_addrs", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("get_accept_addrs", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[1]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("iocpsupport.get_accept_addrs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":40
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":41
  *     cdef sockaddr *localaddr, *remoteaddr
  * 
  *     PyObject_AsReadBuffer(buff, &mem_buffer, &size)             # <<<<<<<<<<<<<<
  * 
  *     lpGetAcceptExSockaddrs(mem_buffer, 0, <DWORD>size / 2, <DWORD>size / 2,
  */
-  __pyx_t_1 = PyObject_AsReadBuffer(__pyx_v_buff, (&__pyx_v_mem_buffer), (&__pyx_v_size)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":43
+  __pyx_t_1 = PyObject_AsReadBuffer(__pyx_v_buff, (&__pyx_v_mem_buffer), (&__pyx_v_size)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":44
  * 
  *     lpGetAcceptExSockaddrs(mem_buffer, 0, <DWORD>size / 2, <DWORD>size / 2,
  *                            &localaddr, &locallen, &remoteaddr, &remotelen)             # <<<<<<<<<<<<<<
@@ -2875,20 +2915,20 @@
  */
   lpGetAcceptExSockaddrs(__pyx_v_mem_buffer, 0, (((__pyx_t_11iocpsupport_DWORD)__pyx_v_size) / 2), (((__pyx_t_11iocpsupport_DWORD)__pyx_v_size) / 2), (&__pyx_v_localaddr), (&__pyx_v_locallen), (&__pyx_v_remoteaddr), (&__pyx_v_remotelen));
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":44
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":45
  *     lpGetAcceptExSockaddrs(mem_buffer, 0, <DWORD>size / 2, <DWORD>size / 2,
  *                            &localaddr, &locallen, &remoteaddr, &remotelen)
  *     return remoteaddr.sa_family, _makesockaddr(localaddr, locallen), _makesockaddr(remoteaddr, remotelen)             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = PyInt_FromLong(__pyx_v_remoteaddr->sa_family); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_2 = PyInt_FromLong(__pyx_v_remoteaddr->sa_family); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_f_11iocpsupport__makesockaddr(__pyx_v_localaddr, __pyx_v_locallen); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __pyx_f_11iocpsupport__makesockaddr(__pyx_v_localaddr, __pyx_v_locallen); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __pyx_f_11iocpsupport__makesockaddr(__pyx_v_remoteaddr, __pyx_v_remotelen); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = __pyx_f_11iocpsupport__makesockaddr(__pyx_v_remoteaddr, __pyx_v_remotelen); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 45; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_5));
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
@@ -3141,7 +3181,7 @@
  *     if not rc:
  *         rc = WSAGetLastError()             # <<<<<<<<<<<<<<
  *         if rc != ERROR_IO_PENDING:
- *             return rc
+ *             PyMem_Free(ov)
  */
     __pyx_v_rc = WSAGetLastError();
 
@@ -3149,8 +3189,8 @@
  *     if not rc:
  *         rc = WSAGetLastError()
  *         if rc != ERROR_IO_PENDING:             # <<<<<<<<<<<<<<
+ *             PyMem_Free(ov)
  *             return rc
- * 
  */
     __pyx_t_3 = (__pyx_v_rc != ERROR_IO_PENDING);
     if (__pyx_t_3) {
@@ -3158,12 +3198,21 @@
       /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\connectex.pxi":32
  *         rc = WSAGetLastError()
  *         if rc != ERROR_IO_PENDING:
+ *             PyMem_Free(ov)             # <<<<<<<<<<<<<<
+ *             return rc
+ * 
+ */
+      PyMem_Free(__pyx_v_ov);
+
+      /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\connectex.pxi":33
+ *         if rc != ERROR_IO_PENDING:
+ *             PyMem_Free(ov)
  *             return rc             # <<<<<<<<<<<<<<
  * 
  *     # operation is in progress
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_1 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 32; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_1 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_r = __pyx_t_1;
       __pyx_t_1 = 0;
@@ -3175,7 +3224,7 @@
   }
   __pyx_L9:;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\connectex.pxi":35
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\connectex.pxi":36
  * 
  *     # operation is in progress
  *     Py_XINCREF(obj)             # <<<<<<<<<<<<<<
@@ -3184,7 +3233,7 @@
  */
   Py_XINCREF(__pyx_v_obj);
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\connectex.pxi":36
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\connectex.pxi":37
  *     # operation is in progress
  *     Py_XINCREF(obj)
  *     return 0             # <<<<<<<<<<<<<<
@@ -3452,7 +3501,7 @@
  *         if rc == SOCKET_ERROR:
  *             rc = WSAGetLastError()             # <<<<<<<<<<<<<<
  *             if rc != ERROR_IO_PENDING:
- *                 return rc, 0
+ *                 PyMem_Free(ov)
  */
       __pyx_v_rc = WSAGetLastError();
 
@@ -3460,8 +3509,8 @@
  *         if rc == SOCKET_ERROR:
  *             rc = WSAGetLastError()
  *             if rc != ERROR_IO_PENDING:             # <<<<<<<<<<<<<<
+ *                 PyMem_Free(ov)
  *                 return rc, 0
- * 
  */
       __pyx_t_6 = (__pyx_v_rc != ERROR_IO_PENDING);
       if (__pyx_t_6) {
@@ -3469,14 +3518,23 @@
         /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":33
  *             rc = WSAGetLastError()
  *             if rc != ERROR_IO_PENDING:
+ *                 PyMem_Free(ov)             # <<<<<<<<<<<<<<
+ *                 return rc, 0
+ * 
+ */
+        PyMem_Free(__pyx_v_ov);
+
+        /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":34
+ *             if rc != ERROR_IO_PENDING:
+ *                 PyMem_Free(ov)
  *                 return rc, 0             # <<<<<<<<<<<<<<
  * 
  *         Py_XINCREF(obj)
  */
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_1 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L7;}
+        __pyx_t_1 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L7;}
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L7;}
+        __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L7;}
         __Pyx_GOTREF(((PyObject *)__pyx_t_7));
         PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1);
         __Pyx_GIVEREF(__pyx_t_1);
@@ -3494,7 +3552,7 @@
     }
     __pyx_L12:;
 
-    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":35
+    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":36
  *                 return rc, 0
  * 
  *         Py_XINCREF(obj)             # <<<<<<<<<<<<<<
@@ -3503,7 +3561,7 @@
  */
     Py_XINCREF(__pyx_v_obj);
 
-    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":36
+    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":37
  * 
  *         Py_XINCREF(obj)
  *         return rc, bytes             # <<<<<<<<<<<<<<
@@ -3511,11 +3569,11 @@
  *         PyMem_Free(ws_buf)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_7 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L7;}
+    __pyx_t_7 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L7;}
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_1 = PyLong_FromUnsignedLong(__pyx_v_bytes); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L7;}
+    __pyx_t_1 = PyLong_FromUnsignedLong(__pyx_v_bytes); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L7;}
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 36; __pyx_clineno = __LINE__; goto __pyx_L7;}
+    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L7;}
     __Pyx_GOTREF(((PyObject *)__pyx_t_8));
     PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_7);
@@ -3528,7 +3586,7 @@
     goto __pyx_L6;
   }
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":38
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":39
  *         return rc, bytes
  *     finally:
  *         PyMem_Free(ws_buf)             # <<<<<<<<<<<<<<
@@ -3582,7 +3640,7 @@
   return __pyx_r;
 }
 
-/* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":40
+/* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":41
  *         PyMem_Free(ws_buf)
  * 
  * def recvfrom(long s, object buff, object addr_buff, object addr_len_buff, object obj, unsigned long flags = 0):             # <<<<<<<<<<<<<<
@@ -3646,25 +3704,25 @@
         values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__buff);
         if (likely(values[1])) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("recvfrom", 0, 5, 6, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+          __Pyx_RaiseArgtupleInvalid("recvfrom", 0, 5, 6, 1); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
         }
         case  2:
         values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__addr_buff);
         if (likely(values[2])) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("recvfrom", 0, 5, 6, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+          __Pyx_RaiseArgtupleInvalid("recvfrom", 0, 5, 6, 2); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
         }
         case  3:
         values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__addr_len_buff);
         if (likely(values[3])) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("recvfrom", 0, 5, 6, 3); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+          __Pyx_RaiseArgtupleInvalid("recvfrom", 0, 5, 6, 3); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
         }
         case  4:
         values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__obj);
         if (likely(values[4])) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("recvfrom", 0, 5, 6, 4); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+          __Pyx_RaiseArgtupleInvalid("recvfrom", 0, 5, 6, 4); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
         }
         case  5:
         if (kw_args > 0) {
@@ -3673,7 +3731,7 @@
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "recvfrom") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "recvfrom") < 0)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
@@ -3687,36 +3745,36 @@
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_s = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_s == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+    __pyx_v_s = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_s == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     __pyx_v_buff = values[1];
     __pyx_v_addr_buff = values[2];
     __pyx_v_addr_len_buff = values[3];
     __pyx_v_obj = values[4];
     if (values[5]) {
-      __pyx_v_flags = __Pyx_PyInt_AsUnsignedLong(values[5]); if (unlikely((__pyx_v_flags == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+      __pyx_v_flags = __Pyx_PyInt_AsUnsignedLong(values[5]); if (unlikely((__pyx_v_flags == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
     } else {
       __pyx_v_flags = ((unsigned long)0);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("recvfrom", 0, 5, 6, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
+  __Pyx_RaiseArgtupleInvalid("recvfrom", 0, 5, 6, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[3]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
   __pyx_L3_error:;
   __Pyx_AddTraceback("iocpsupport.recvfrom", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":49
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":50
  *     cdef Py_ssize_t size
  * 
  *     PyObject_AsWriteBuffer(buff, <void **>&ws_buf.buf, &size)             # <<<<<<<<<<<<<<
  *     ws_buf.len = <DWORD>size
  *     PyObject_AsWriteBuffer(addr_buff, <void **>&c_addr_buff, &size)
  */
-  __pyx_t_1 = PyObject_AsWriteBuffer(__pyx_v_buff, ((void **)(&__pyx_v_ws_buf.buf)), (&__pyx_v_size)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 49; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":50
+  __pyx_t_1 = PyObject_AsWriteBuffer(__pyx_v_buff, ((void **)(&__pyx_v_ws_buf.buf)), (&__pyx_v_size)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":51
  * 
  *     PyObject_AsWriteBuffer(buff, <void **>&ws_buf.buf, &size)
  *     ws_buf.len = <DWORD>size             # <<<<<<<<<<<<<<
@@ -3725,16 +3783,16 @@
  */
   __pyx_v_ws_buf.len = ((__pyx_t_11iocpsupport_DWORD)__pyx_v_size);
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":51
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":52
  *     PyObject_AsWriteBuffer(buff, <void **>&ws_buf.buf, &size)
  *     ws_buf.len = <DWORD>size
  *     PyObject_AsWriteBuffer(addr_buff, <void **>&c_addr_buff, &size)             # <<<<<<<<<<<<<<
  *     c_addr_buff_len = <int>size
  *     PyObject_AsWriteBuffer(addr_len_buff, <void **>&c_addr_len_buff, &size)
  */
-  __pyx_t_1 = PyObject_AsWriteBuffer(__pyx_v_addr_buff, ((void **)(&__pyx_v_c_addr_buff)), (&__pyx_v_size)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 51; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":52
+  __pyx_t_1 = PyObject_AsWriteBuffer(__pyx_v_addr_buff, ((void **)(&__pyx_v_c_addr_buff)), (&__pyx_v_size)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":53
  *     ws_buf.len = <DWORD>size
  *     PyObject_AsWriteBuffer(addr_buff, <void **>&c_addr_buff, &size)
  *     c_addr_buff_len = <int>size             # <<<<<<<<<<<<<<
@@ -3743,16 +3801,16 @@
  */
   __pyx_v_c_addr_buff_len = ((int)__pyx_v_size);
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":53
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":54
  *     PyObject_AsWriteBuffer(addr_buff, <void **>&c_addr_buff, &size)
  *     c_addr_buff_len = <int>size
  *     PyObject_AsWriteBuffer(addr_len_buff, <void **>&c_addr_len_buff, &size)             # <<<<<<<<<<<<<<
  *     c_addr_len_buff_len = <int>size
  * 
  */
-  __pyx_t_1 = PyObject_AsWriteBuffer(__pyx_v_addr_len_buff, ((void **)(&__pyx_v_c_addr_len_buff)), (&__pyx_v_size)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
-
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":54
+  __pyx_t_1 = PyObject_AsWriteBuffer(__pyx_v_addr_len_buff, ((void **)(&__pyx_v_c_addr_len_buff)), (&__pyx_v_size)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":55
  *     c_addr_buff_len = <int>size
  *     PyObject_AsWriteBuffer(addr_len_buff, <void **>&c_addr_len_buff, &size)
  *     c_addr_len_buff_len = <int>size             # <<<<<<<<<<<<<<
@@ -3761,7 +3819,7 @@
  */
   __pyx_v_c_addr_len_buff_len = ((int)__pyx_v_size);
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":56
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":57
  *     c_addr_len_buff_len = <int>size
  * 
  *     if c_addr_len_buff_len != sizeof(int):             # <<<<<<<<<<<<<<
@@ -3771,7 +3829,7 @@
   __pyx_t_2 = (__pyx_v_c_addr_len_buff_len != (sizeof(int)));
   if (__pyx_t_2) {
 
-    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":57
+    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":58
  * 
  *     if c_addr_len_buff_len != sizeof(int):
  *         raise ValueError, 'length of address length buffer needs to be sizeof(int)'             # <<<<<<<<<<<<<<
@@ -3779,12 +3837,12 @@
  *     c_addr_len_buff[0] = c_addr_buff_len
  */
     __Pyx_Raise(__pyx_builtin_ValueError, ((PyObject *)__pyx_kp_s_11), 0, 0);
-    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 57; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[3]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L6;
   }
   __pyx_L6:;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":59
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":60
  *         raise ValueError, 'length of address length buffer needs to be sizeof(int)'
  * 
  *     c_addr_len_buff[0] = c_addr_buff_len             # <<<<<<<<<<<<<<
@@ -3793,17 +3851,17 @@
  */
   (__pyx_v_c_addr_len_buff[0]) = __pyx_v_c_addr_buff_len;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":61
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":62
  *     c_addr_len_buff[0] = c_addr_buff_len
  * 
  *     ov = makeOV()             # <<<<<<<<<<<<<<
  *     if obj is not None:
  *         ov.obj = <PyObject *>obj
  */
-  __pyx_t_3 = __pyx_f_11iocpsupport_makeOV(); if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_3 = __pyx_f_11iocpsupport_makeOV(); if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_v_ov = __pyx_t_3;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":62
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":63
  * 
  *     ov = makeOV()
  *     if obj is not None:             # <<<<<<<<<<<<<<
@@ -3813,7 +3871,7 @@
   __pyx_t_2 = (__pyx_v_obj != Py_None);
   if (__pyx_t_2) {
 
-    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":63
+    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":64
  *     ov = makeOV()
  *     if obj is not None:
  *         ov.obj = <PyObject *>obj             # <<<<<<<<<<<<<<
@@ -3825,7 +3883,7 @@
   }
   __pyx_L7:;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":65
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":66
  *         ov.obj = <PyObject *>obj
  * 
  *     rc = WSARecvFrom(s, &ws_buf, 1, &bytes, &flags, c_addr_buff, c_addr_len_buff, <OVERLAPPED *>ov, NULL)             # <<<<<<<<<<<<<<
@@ -3834,7 +3892,7 @@
  */
   __pyx_v_rc = WSARecvFrom(__pyx_v_s, (&__pyx_v_ws_buf), 1, (&__pyx_v_bytes), (&__pyx_v_flags), __pyx_v_c_addr_buff, __pyx_v_c_addr_len_buff, ((OVERLAPPED *)__pyx_v_ov), NULL);
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":67
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":68
  *     rc = WSARecvFrom(s, &ws_buf, 1, &bytes, &flags, c_addr_buff, c_addr_len_buff, <OVERLAPPED *>ov, NULL)
  * 
  *     if rc == SOCKET_ERROR:             # <<<<<<<<<<<<<<
@@ -3844,36 +3902,45 @@
   __pyx_t_2 = (__pyx_v_rc == SOCKET_ERROR);
   if (__pyx_t_2) {
 
-    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":68
+    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":69
  * 
  *     if rc == SOCKET_ERROR:
  *         rc = WSAGetLastError()             # <<<<<<<<<<<<<<
  *         if rc != ERROR_IO_PENDING:
- *             return rc, 0
+ *             PyMem_Free(ov)
  */
     __pyx_v_rc = WSAGetLastError();
 
-    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":69
+    /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":70
  *     if rc == SOCKET_ERROR:
  *         rc = WSAGetLastError()
  *         if rc != ERROR_IO_PENDING:             # <<<<<<<<<<<<<<
+ *             PyMem_Free(ov)
  *             return rc, 0
- * 
  */
     __pyx_t_2 = (__pyx_v_rc != ERROR_IO_PENDING);
     if (__pyx_t_2) {
 
-      /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":70
+      /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":71
  *         rc = WSAGetLastError()
  *         if rc != ERROR_IO_PENDING:
+ *             PyMem_Free(ov)             # <<<<<<<<<<<<<<
+ *             return rc, 0
+ * 
+ */
+      PyMem_Free(__pyx_v_ov);
+
+      /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":72
+ *         if rc != ERROR_IO_PENDING:
+ *             PyMem_Free(ov)
  *             return rc, 0             # <<<<<<<<<<<<<<
  * 
  *     Py_XINCREF(obj)
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_4 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(((PyObject *)__pyx_t_5));
       PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_4);
@@ -3891,7 +3958,7 @@
   }
   __pyx_L8:;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":72
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":74
  *             return rc, 0
  * 
  *     Py_XINCREF(obj)             # <<<<<<<<<<<<<<
@@ -3900,18 +3967,18 @@
  */
   Py_XINCREF(__pyx_v_obj);
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":73
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":75
  * 
  *     Py_XINCREF(obj)
  *     return rc, bytes             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = PyLong_FromUnsignedLong(__pyx_v_bytes); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyLong_FromUnsignedLong(__pyx_v_bytes); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_6));
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
@@ -4112,7 +4179,7 @@
  *     if rc == SOCKET_ERROR:
  *         rc = WSAGetLastError()             # <<<<<<<<<<<<<<
  *         if rc != ERROR_IO_PENDING:
- *             return rc, bytes
+ *             PyMem_Free(ov)
  */
     __pyx_v_rc = WSAGetLastError();
 
@@ -4120,8 +4187,8 @@
  *     if rc == SOCKET_ERROR:
  *         rc = WSAGetLastError()
  *         if rc != ERROR_IO_PENDING:             # <<<<<<<<<<<<<<
+ *             PyMem_Free(ov)
  *             return rc, bytes
- * 
  */
     __pyx_t_3 = (__pyx_v_rc != ERROR_IO_PENDING);
     if (__pyx_t_3) {
@@ -4129,16 +4196,25 @@
       /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsasend.pxi":24
  *         rc = WSAGetLastError()
  *         if rc != ERROR_IO_PENDING:
+ *             PyMem_Free(ov)             # <<<<<<<<<<<<<<
+ *             return rc, bytes
+ * 
+ */
+      PyMem_Free(__pyx_v_ov);
+
+      /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsasend.pxi":25
+ *         if rc != ERROR_IO_PENDING:
+ *             PyMem_Free(ov)
  *             return rc, bytes             # <<<<<<<<<<<<<<
  * 
  *     Py_XINCREF(obj)
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_4 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_4 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = PyLong_FromUnsignedLong(__pyx_v_bytes); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_5 = PyLong_FromUnsignedLong(__pyx_v_bytes); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
       __Pyx_GOTREF(((PyObject *)__pyx_t_6));
       PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_4);
@@ -4156,7 +4232,7 @@
   }
   __pyx_L7:;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsasend.pxi":26
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsasend.pxi":27
  *             return rc, bytes
  * 
  *     Py_XINCREF(obj)             # <<<<<<<<<<<<<<
@@ -4165,7 +4241,7 @@
  */
   Py_XINCREF(__pyx_v_obj);
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsasend.pxi":27
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsasend.pxi":28
  * 
  *     Py_XINCREF(obj)
  *     return rc, bytes             # <<<<<<<<<<<<<<
@@ -4173,11 +4249,11 @@
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_6 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_6 = PyInt_FromLong(__pyx_v_rc); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = PyLong_FromUnsignedLong(__pyx_v_bytes); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_5 = PyLong_FromUnsignedLong(__pyx_v_bytes); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[4]; __pyx_lineno = 28; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_t_4));
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
@@ -4445,7 +4521,7 @@
   {0, 0, 0, 0, 0, 0, 0}
 };
 static int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_ValueError = __Pyx_GetName(__pyx_b, __pyx_n_s__ValueError); if (!__pyx_builtin_ValueError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_builtin_ValueError = __Pyx_GetName(__pyx_b, __pyx_n_s__ValueError); if (!__pyx_builtin_ValueError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __pyx_builtin_MemoryError = __Pyx_GetName(__pyx_b, __pyx_n_s__MemoryError); if (!__pyx_builtin_MemoryError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   return 0;
   __pyx_L1_error:;
@@ -4456,14 +4532,14 @@
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants");
 
-  /* "iocpsupport.pyx":221
+  /* "iocpsupport.pyx":224
  *             raise_error(0, 'WSAAddressToString')
  *         host, sa_port = PyString_FromString(buff), ntohs(sin6.sin6_port)
  *         host, port = host.rsplit(':', 1)             # <<<<<<<<<<<<<<
  *         port = int(port)
  *         assert host[0] == '['
  */
-  __pyx_k_tuple_4 = PyTuple_New(2); if (unlikely(!__pyx_k_tuple_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_k_tuple_4 = PyTuple_New(2); if (unlikely(!__pyx_k_tuple_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_4));
   __Pyx_INCREF(((PyObject *)__pyx_kp_s_3));
   PyTuple_SET_ITEM(__pyx_k_tuple_4, 0, ((PyObject *)__pyx_kp_s_3));
@@ -4592,55 +4668,55 @@
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
 
-  /* "iocpsupport.pyx":196
+  /* "iocpsupport.pyx":199
  *         CloseHandle(self.port)
  * 
  * def makesockaddr(object buff):             # <<<<<<<<<<<<<<
  *     cdef void *mem_buffer
  *     cdef Py_ssize_t size
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11iocpsupport_makesockaddr, NULL, __pyx_n_s__iocpsupport); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11iocpsupport_makesockaddr, NULL, __pyx_n_s__iocpsupport); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__makesockaddr, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__makesockaddr, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "iocpsupport.pyx":244
+  /* "iocpsupport.pyx":247
  *     dest.sin_port = htons(port)
  * 
  * def AllocateReadBuffer(int size):             # <<<<<<<<<<<<<<
  *     return PyBuffer_New(size)
  * 
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11iocpsupport_1AllocateReadBuffer, NULL, __pyx_n_s__iocpsupport); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11iocpsupport_1AllocateReadBuffer, NULL, __pyx_n_s__iocpsupport); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__AllocateReadBuffer, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__AllocateReadBuffer, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "iocpsupport.pyx":247
+  /* "iocpsupport.pyx":250
  *     return PyBuffer_New(size)
  * 
  * def maxAddrLen(long s):             # <<<<<<<<<<<<<<
  *     cdef WSAPROTOCOL_INFO wsa_pi
  *     cdef int size, rc
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11iocpsupport_2maxAddrLen, NULL, __pyx_n_s__iocpsupport); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11iocpsupport_2maxAddrLen, NULL, __pyx_n_s__iocpsupport); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__maxAddrLen, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__maxAddrLen, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "iocpsupport.pyx":267
+  /* "iocpsupport.pyx":270
  *     return wsa_pi.iAddressFamily
  * 
  * import socket # for WSAStartup             # <<<<<<<<<<<<<<
  * if not initWinsockPointers():
  *     raise ValueError, 'Failed to initialize Winsock function vectors'
  */
-  __pyx_t_1 = __Pyx_Import(((PyObject *)__pyx_n_s__socket), 0, -1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_Import(((PyObject *)__pyx_n_s__socket), 0, -1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__socket, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__socket, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "iocpsupport.pyx":268
+  /* "iocpsupport.pyx":271
  * 
  * import socket # for WSAStartup
  * if not initWinsockPointers():             # <<<<<<<<<<<<<<
@@ -4650,7 +4726,7 @@
   __pyx_t_3 = (!initWinsockPointers());
   if (__pyx_t_3) {
 
-    /* "iocpsupport.pyx":269
+    /* "iocpsupport.pyx":272
  * import socket # for WSAStartup
  * if not initWinsockPointers():
  *     raise ValueError, 'Failed to initialize Winsock function vectors'             # <<<<<<<<<<<<<<
@@ -4658,21 +4734,21 @@
  * have_connectex = (lpConnectEx != NULL)
  */
     __Pyx_Raise(__pyx_builtin_ValueError, ((PyObject *)__pyx_kp_s_12), 0, 0);
-    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
     goto __pyx_L2;
   }
   __pyx_L2:;
 
-  /* "iocpsupport.pyx":271
+  /* "iocpsupport.pyx":274
  *     raise ValueError, 'Failed to initialize Winsock function vectors'
  * 
  * have_connectex = (lpConnectEx != NULL)             # <<<<<<<<<<<<<<
  * 
  * include 'acceptex.pxi'
  */
-  __pyx_t_1 = __Pyx_PyBool_FromLong((lpConnectEx != NULL)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = __Pyx_PyBool_FromLong((lpConnectEx != NULL)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__have_connectex, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__have_connectex, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":5
@@ -4687,16 +4763,16 @@
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s__accept, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":33
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\acceptex.pxi":34
  *     return 0
  * 
  * def get_accept_addrs(long s, object buff):             # <<<<<<<<<<<<<<
  *     cdef WSAPROTOCOL_INFO wsa_pi
  *     cdef int locallen, remotelen
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11iocpsupport_4get_accept_addrs, NULL, __pyx_n_s__iocpsupport); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11iocpsupport_4get_accept_addrs, NULL, __pyx_n_s__iocpsupport); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__get_accept_addrs, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 33; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__get_accept_addrs, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\connectex.pxi":5
@@ -4715,16 +4791,16 @@
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s__recv, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":40
+  /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsarecv.pxi":41
  *         PyMem_Free(ws_buf)
  * 
  * def recvfrom(long s, object buff, object addr_buff, object addr_len_buff, object obj, unsigned long flags = 0):             # <<<<<<<<<<<<<<
  *     cdef int rc, c_addr_buff_len, c_addr_len_buff_len
  *     cdef myOVERLAPPED *ov
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11iocpsupport_7recvfrom, NULL, __pyx_n_s__iocpsupport); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_11iocpsupport_7recvfrom, NULL, __pyx_n_s__iocpsupport); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__recvfrom, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__recvfrom, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 41; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "C:\t\twisted\twisted\internet\iocpreactor\iocpsupport\wsasend.pxi":5
diff -r 06facfeb754a twisted/internet/iocpreactor/iocpsupport/iocpsupport.pyx
--- a/twisted/internet/iocpreactor/iocpsupport/iocpsupport.pyx	Sun Jan 15 03:23:55 2012 +0100
+++ b/twisted/internet/iocpreactor/iocpsupport/iocpsupport.pyx	Sun Jan 15 18:47:42 2012 +0100
@@ -188,6 +188,9 @@
 
         rc = PostQueuedCompletionStatus(self.port, bytes, key, <OVERLAPPED *>ov)
         if not rc:
+            if ov:
+                Py_DECREF(obj)
+                PyMem_Free(ov)
             raise_error(0, 'PostQueuedCompletionStatus')
 
     def __del__(self):
diff -r 06facfeb754a twisted/internet/iocpreactor/iocpsupport/wsarecv.pxi
--- a/twisted/internet/iocpreactor/iocpsupport/wsarecv.pxi	Sun Jan 15 03:23:55 2012 +0100
+++ b/twisted/internet/iocpreactor/iocpsupport/wsarecv.pxi	Sun Jan 15 18:47:42 2012 +0100
@@ -30,6 +30,7 @@
         if rc == SOCKET_ERROR:
             rc = WSAGetLastError()
             if rc != ERROR_IO_PENDING:
+                PyMem_Free(ov)
                 return rc, 0
 
         Py_XINCREF(obj)
@@ -67,6 +68,7 @@
     if rc == SOCKET_ERROR:
         rc = WSAGetLastError()
         if rc != ERROR_IO_PENDING:
+            PyMem_Free(ov)
             return rc, 0
 
     Py_XINCREF(obj)
diff -r 06facfeb754a twisted/internet/iocpreactor/iocpsupport/wsasend.pxi
--- a/twisted/internet/iocpreactor/iocpsupport/wsasend.pxi	Sun Jan 15 03:23:55 2012 +0100
+++ b/twisted/internet/iocpreactor/iocpsupport/wsasend.pxi	Sun Jan 15 18:47:42 2012 +0100
@@ -21,6 +21,7 @@
     if rc == SOCKET_ERROR:
         rc = WSAGetLastError()
         if rc != ERROR_IO_PENDING:
+            PyMem_Free(ov)
             return rc, bytes
 
     Py_XINCREF(obj)
