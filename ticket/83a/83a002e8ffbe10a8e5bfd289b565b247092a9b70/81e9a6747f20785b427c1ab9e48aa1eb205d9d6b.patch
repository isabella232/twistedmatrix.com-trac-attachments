Index: tap2ntsvc.py
===================================================================
--- tap2ntsvc.py	(revision 10903)
+++ tap2ntsvc.py	(working copy)
@@ -200,11 +200,13 @@
 from distutils.core import setup
 import py2exe
 
+serviceModule = "%(name)ssvc"
 scriptfile = "%(script)s"
 configfile = "%(confbase)s"
 
 def run(argv = sys.argv):
-    setup_args = {"scripts": [scriptfile],
+    setup_args = {"service": [serviceModule],
+                  "scripts": [scriptfile],
                   "data_files": [("", [configfile]),
                                  ],
                   }
@@ -221,21 +223,19 @@
 cfg_template = '''\
 ## This file was generated by tap2ntsvc, with the command line:
 ##   %(commandline)s
+[global]
+version = %(package_version)s
+name = %(display_name)s
+icon_resources = %(icon)s
+
 [py2exe]
 
-service=%(name)s_ServiceControl
 ## prune docstrings (py2exe ignores them)
 optimize=2
 excludes=perfmon
-# version_companyname =
-# version_fileversion =
-# version_legalcopyright =
-# version_legaltrademarks =
-version_productversion = %(package_version)s
-icon = %(icon)s
-version_filedescription = %(description)s
-version_productname = %(display_name)s
+description = %(description)s
 includes = %(includes)s
+
 '''
 
 servicectl_template = '''\
@@ -315,7 +315,7 @@
 # write an fmlang script so future runs will operate on the (possibly
 # user-edited) commands list, and not a static list of files
 if not os.path.isfile(filemapper):
-    scr.collect(os.path.join("dist", "%(name)ssvc"))
+    scr.collect(".")
     file(filemapper, "w").write(scr.fmscript)
     print "Created %%s" %% filemapper
 else:
